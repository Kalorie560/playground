# 🚀 宇宙船タイタニック ディープラーニングソリューション

> Kaggle宇宙船タイタニックコンペティション向けの完全な機械学習ソリューション

## 📊 概要

このプロジェクトは、Kaggle宇宙船タイタニックコンペティション向けのエンドツーエンドソリューションを提供します。コンペティションの目標は、宇宙船が時空異常に衝突した際に、どの乗客が別次元に輸送されたかを予測することです。

### 🎯 このプロジェクトでできること

- **乗客の輸送を予測**: 先進的なディープラーニング技術を使用
- **インタラクティブなウェブインターフェース**: リアルタイム予測を提供
- **実験の追跡**: 包括的なログとメトリクスで監視
- **複数の使用モード**: ウェブアプリ、コマンドライン、プログラムAPIに対応

## ✨ 主要機能

| 機能 | 説明 |
|------|------|
| 🧠 **スマートAIモデル** | 設定可能なアーキテクチャのPyTorchニューラルネットワーク |
| 🌐 **ウェブインターフェース** | 日本語対応のユーザーフレンドリーなStreamlitアプリ |
| 📈 **実験トラッキング** | モデル性能監視のためのClearML統合 |
| ⚙️ **簡単設定** | 全ハイパーパラメータのYAMLベース設定 |
| 🔧 **特徴エンジニアリング** | 高度なデータ前処理と特徴抽出 |
| 📊 **包括的メトリクス** | 詳細な性能評価と可視化 |
| 🎲 **再現可能な結果** | 一貫した結果のためのシード管理 |

## 📁 プロジェクト構造

```
├── config.yaml                 # すべてのハイパーパラメータの設定ファイル
├── data_preprocessing.py        # データ読み込み、クリーニング、特徴エンジニアリング
├── model.py                    # ニューラルネットワークアーキテクチャとユーティリティ
├── train.py                    # ClearML統合を含む訓練パイプライン
├── predict.py                  # テストセット予測と提出ファイル生成
├── app.py                      # インタラクティブ予測のためのStreamlitウェブアプリケーション
├── run_app.py                  # ウェブアプリケーション起動用Pythonスクリプト
├── run_app.sh                  # ウェブアプリケーション起動用バッシュスクリプト
├── setup_clearml.py            # インタラクティブClearMLセットアップヘルパー
├── requirements.txt            # Python依存関係
├── README.md                   # メインドキュメント（英語）
├── README_ja.md                # 日本語ドキュメント
└── WEB_APP_README.md           # 詳細なウェブアプリケーションドキュメント
```

## 🚀 クイックスタートガイド

### ステップ1: 環境のセットアップ

```bash
# リポジトリのクローン（まだ行っていない場合）
git clone <repository-url>
cd playground

# 依存関係のインストール
pip install -r requirements.txt
```

### ステップ2: データの準備

Kaggleコンペティションファイルをプロジェクトルートに追加：
```
📁 playground/
├── train.csv     ← 訓練データ
├── test.csv      ← テストデータ
└── ...
```

> 💡 **データがない場合**: システムが自動的にテスト用のサンプルデータを生成します！

### ステップ3: 使用方法を選択

#### 🎮 オプションA: インタラクティブウェブアプリ（初心者推奨）

視覚的なインターフェースで予測を探索するのに最適：

```bash
python run_app.py
```

その後、ブラウザで http://localhost:8501 を開く

#### 🖥️ オプションB: コマンドライン（データサイエンティスト向け）

独自のモデルを訓練して予測を生成：

```bash
# モデルの訓練
python train.py

# 予測の実行
python predict.py
```

#### 🔧 オプションC: カスタム設定

異なる設定で実験：

```bash
# config.yamlを好みに編集してから：
python train.py --config config.yaml
```

## 🌐 インタラクティブウェブアプリケーション

直感的なウェブインターフェースでAI予測の力を体験しましょう！

### 🎨 利用できる機能

| 機能 | メリット |
|------|----------|
| 🖱️ **ポイント＆クリックインターフェース** | コーディング不要 - フォームに入力するだけ |
| 🌏 **バイリンガル対応** | 完全な日本語・英語サポート |
| ⚡ **即座の結果** | 入力と同時にリアルタイムで予測 |
| 📊 **視覚的フィードバック** | 確率スコアと信頼度メトリクスを表示 |
| 🛡️ **スマート検証** | 自動エラーチェックとデータフォーマット |

### 📝 入力情報

乗客の詳細を簡単に入力：

- 🏠 **背景情報**: ホームプラネット、年齢、VIPステータス、冷凍睡眠状態
- 🏨 **宿泊詳細**: キャビンデッキ、番号、サイドの選択
- 🎯 **目的地**: 銀河系内の行き先
- 💰 **支出**: 船内設備とサービスでの支出

### 📈 予測結果

AIが表示する内容：
- 🎯 **輸送確率**（0-100%）
- 📊 **信頼度の詳細**と詳細メトリクス
- 💵 **支出分析**とパターン
- 📋 **入力要約**（確認用）

## ⚙️ 簡単設定

すべてが`config.yaml`で制御されます - コード変更は不要！

### 🎛️ クイック設定

```yaml
# モデル調整
model:
  hidden_sizes: [256, 128, 64]  # ネットワークサイズ
  dropout_rates: [0.3, 0.4, 0.5]  # 過学習防止
  activation: "relu"  # 活性化関数

# 訓練動作
training:
  batch_size: 64  # ステップあたりのデータ量
  learning_rate: 0.001  # 学習の速さ
  epochs: 100  # 訓練時間
```

### 🔧 高度なオプション

- **データパス**: train/testのCSVファイルを指定
- **検証分割**: テスト用データの割合（デフォルト: 20%）
- **再現性**: 一貫した結果のためのランダムシード設定
- **ハードウェア**: GPU/CPUの自動検出または強制指定
- **実験トラッキング**: 監視用のClearML接続

## 🔧 AIの仕組み

### 🧹 スマートデータ処理

システムがデータを自動的にクリーニング・準備：

- **欠損値を賢く補完**（数値は中央値、カテゴリは最頻値）
- **既存データから新特徴を作成**（キャビンデッキ、家族サイズ、支出パターン）
- **機械学習互換にカテゴリをエンコード**
- **ニューラルネットワーク用に数値をスケール**

### 🧠 ニューラルネットワーク構造

複数の層を持つデジタル脳のような構造：

```
入力 → 隠れ層1（256ニューロン） → 隠れ層2（128ニューロン） → 隠れ層3（64ニューロン） → 予測
```

**スマートな理由：**
- 🎯 **ドロップアウト防止**: 記憶ではなくパターンに焦点
- 📊 **バッチ正規化**: 学習を安定・高速化
- ⚡ **ReLU活性化**: 効率的な数学的判断関数
- 🎛️ **設定可能サイズ**: ニーズに合わせて複雑度調整

### 🎓 訓練プロセス

AIは以下を通じて学習：
- **損失計算**: 予測の間違いを測定
- **誤差逆伝播**: エラーを減らすためにニューロンを調整
- **早期停止**: 改善が停滞したら過学習を防止
- **学習率スケジューリング**: 高速で開始、精度のため減速

## 📊 実験トラッキング（オプション）

プロのようにモデルの訓練を監視したいですか？ClearML統合が含まれています！

### 🚀 簡単セットアップ

```bash
# スクリプトがセットアップをガイドします
python setup_clearml.py
```

**利用できる機能：**
- 📈 リアルタイム訓練グラフ
- 📊 性能メトリクス追跡
- 🔄 実験比較ツール
- 💾 自動モデル保存
- 📋 完全な訓練ログ

### 🎯 追跡される内容

| メトリクスタイプ | 例 |
|------------------|---|
| 📈 **訓練進行** | 損失曲線、時間経過による精度 |
| 🎯 **性能** | 適合率、再現率、F1スコア、AUC |
| ⚙️ **設定** | すべてのハイパーパラメータと設定 |
| 📊 **データ統計** | データセットサイズ、特徴分布 |
| 🏆 **最終結果** | ベストモデルの性能とメトリクス |

> 💡 **トラッキングが不要？** 問題ありません！システムはClearMLなしでも完璧に動作します。

## 📋 一般的な使用パターン

### 🎯 設定の実験

異なるモデル設定を試したいですか？簡単です！

```bash
# 独自の設定ファイルを作成
cp config.yaml my_experiment.yaml

# my_experiment.yamlを編集してから：
python train.py --config my_experiment.yaml
```

### 🔄 プログラム的使用

AIを独自のPythonコードに統合：

```python
# クイック予測パイプライン
from data_preprocessing import SpaceshipDataProcessor
from model import create_model

# データを処理
processor = SpaceshipDataProcessor()
train_df, test_df = processor.load_data('train.csv', 'test.csv')
X_train, X_test, y_train = processor.preprocess(train_df, test_df)

# 訓練と予測
from train import SpaceshipTrainer
trainer = SpaceshipTrainer('config.yaml')
model, metrics = trainer.train()
```

### 🎮 ウェブアプリ統合

```python
# 独自アプリでウェブ予測器を使用
from app import SpaceshipWebPredictor

predictor = SpaceshipWebPredictor()
result = predictor.predict({
    'home_planet': 'Earth',
    'age': 25,
    'vip': False,
    # ... その他の乗客詳細を追加
})
print(f"輸送確率: {result}%")
```

## 📈 結果の理解

### 📊 主要メトリクス解説

| メトリクス | 意味 | 良いスコア |
|------------|------|------------|
| **精度** | 全体的にモデルがどれだけ正確か | > 80% |
| **適合率** | 予測された輸送のうち、実際に正しかった割合 | > 75% |
| **再現率** | 実際の輸送のうち、どれだけキャッチできたか | > 75% |
| **F1スコア** | 適合率と再現率のバランス指標 | > 75% |
| **AUC** | モデルが2つのクラスをどれだけよく分離できるか | > 0.85 |

### 📁 出力ファイル

訓練と予測後に得られるファイル：

- 📦 `best_model.pth` - 訓練済みAIモデル
- 📄 `submission.csv` - Kaggle提出用ファイル
- 📊 `detailed_predictions.csv` - 分析用の確率データ

## 💡 より良い結果のためのヒント

### 🎛️ これらの設定を試してみる

```yaml
# より高い精度のため
model:
  hidden_sizes: [512, 256, 128]  # より大きなネットワーク
  dropout_rates: [0.2, 0.3, 0.4]  # ドロップアウトを少なく

# より高速な訓練のため
training:
  batch_size: 128  # より大きなバッチ
  learning_rate: 0.003  # より高速な学習
```

### 🚀 高度なテクニック

1. **クロスバリデーション**: 堅牢性のため複数モデルを訓練
2. **アンサンブル手法**: 複数モデルの予測を組み合わせ
3. **特徴エンジニアリング**: 既存データから新しい特徴を作成
4. **ハイパーパラメータ探索**: 異なる設定を体系的に試行

## 🐛 トラブルシューティング

よくある問題の解決方法をご紹介します：

### 💾 メモリ問題

```bash
# メモリ不足エラーが発生する場合
# config.yamlを編集して次を削減：
training:
  batch_size: 32  # これを小さくする
```

またはCPU使用を強制：
```yaml
hardware:
  device: "cpu"  # GPUの代わりにCPUを使用
```

### 🌐 ウェブアプリが起動しない

```bash
# ポートが既に使用されている場合？
streamlit run app.py --server.port 8502

# 依存関係が不足している場合？
pip install -r requirements.txt
```

### 📁 データファイルの問題

- **train.csv/test.csvがない？** 心配無用！サンプルデータが自動生成されます
- **ファイル形式が間違っている？** CSVファイルが期待される列を持っているか確認
- **ファイルパスエラー？** CSVファイルをプロジェクトルートディレクトリに配置

### 🔗 ClearML接続問題

```bash
# セットアップヘルパーを実行
python setup_clearml.py

# またはスキップ - ClearMLなしでも訓練は動作します！
```

### ❓ まだ問題が解決しない？

1. コンソール出力で詳細なエラーメッセージを確認
2. すべての依存関係が正しくインストールされているか確認
3. まずサンプルデータでセットアップをテスト
4. ファイルの権限とパスを確認

## 📋 システム要件

| コンポーネント | バージョン | 必須 |
|---------------|------------|------|
| Python | 3.7+ | ✅ はい |
| PyTorch | 2.0+ | ✅ はい |
| Streamlit | 1.28+ | ✅ はい |
| pandas | 1.5+ | ✅ はい |
| scikit-learn | 1.3+ | ✅ はい |
| ClearML | 1.14+ | ❌ オプション |

## 📄 ライセンスと謝辞

📚 **教育用途**: このプロジェクトは学習およびKaggleコンペティション参加用に設計されています。

🙏 **謝辞**:
- Kaggle宇宙船タイタニックコンペティション
- PyTorch、Streamlit、オープンソースMLコミュニティ
- 優秀な実験トラッキングツールのClearMLチーム

---

**🚀 未来を予測する準備はできましたか？さあ始めましょう！**